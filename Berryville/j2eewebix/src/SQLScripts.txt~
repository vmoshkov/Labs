CREATE DATABASE carsdeskdb;
USE carsdeskdb;


CREATE TABLE `manufacturer` (
  `id` INTEGER PRIMARY KEY AUTO_INCREMENT,
  `name` VARCHAR(255) UNIQUE NOT NULL,
  `country` VARCHAR(255) NOT NULL
);

CREATE TABLE `car` (
  `id` INTEGER PRIMARY KEY AUTO_INCREMENT,
  `entry_date` DATE NOT NULL,
  `manufacturer_id` INTEGER NOT NULL,
  `model` VARCHAR(255) NOT NULL,
  `year` INTEGER NOT NULL,
  `description` LONGTEXT NOT NULL,
  `prise` DOUBLE NOT NULL,
  `contact_person` VARCHAR(255) NOT NULL,
  `contact_phone` VARCHAR(255) NOT NULL
);

CREATE INDEX `idx_car__manufacturer_id` ON `car` (`manufacturer_id`);

ALTER TABLE `car` ADD CONSTRAINT `fk_car__manufacturer_id` FOREIGN KEY (`manufacturer_id`) REFERENCES `manufacturer` (`id`);

CREATE TABLE `image` (
  `id` INTEGER PRIMARY KEY AUTO_INCREMENT,
  `filename` VARCHAR(255) NOT NULL,
  `data` LONGBLOB NOT NULL,
  `car_id` INTEGER NOT NULL
);

CREATE INDEX `idx_image__car_id` ON `image` (`car_id`);

ALTER TABLE `image` ADD CONSTRAINT `fk_image__car_id` FOREIGN KEY (`car_id`) REFERENCES `car` (`id`);


**************************
**** DERBY DB ***********
*************************

CREATE TABLE manufacturer (
  id INTEGER PRIMARY KEY,
  name VARCHAR(255) UNIQUE NOT NULL,
  country VARCHAR(255) NOT NULL
);

CREATE TABLE car (
  id INTEGER PRIMARY KEY,
  entry_date DATE NOT NULL,
  manufacturer_id INTEGER NOT NULL,
  model VARCHAR(255) NOT NULL,
  car_year INTEGER NOT NULL,
  description VARCHAR(4000) NOT NULL,
  prise DOUBLE NOT NULL,
  contact_person VARCHAR(255) NOT NULL,
  contact_phone VARCHAR(255) NOT NULL
);

CREATE INDEX idx_car__manufacturer_id ON car (manufacturer_id);

ALTER TABLE car ADD CONSTRAINT fk_car__manufacturer_id FOREIGN KEY (manufacturer_id) REFERENCES manufacturer (id);

CREATE TABLE image (
  id INTEGER PRIMARY KEY,
  filename VARCHAR(255) NOT NULL,
  data blob(1M) NOT NULL,
  car_id INTEGER NOT NULL
);




